apiVersion: v1alpha1
kind: Role
metadata:
  name: plugin-encrypt-anonymous
  labels:
    halo.run/role-template: "true"
    halo.run/hidden: "true"
    rbac.authorization.halo.run/aggregate-to-anonymous: "true"
rules:
  - apiGroups: ["plugin-paywall.halo.run"]
    resources: ["paywall"]
    resourceNames: [ "purchase","status","content" ]
    verbs: ["create","get","list","watch","update","patch","delete"]
  - nonResourceURLs: [
    "/apis/plugin-paywall.halo.run/v1alpha1/paywall/purchase",
    "/apis/plugin-paywall.halo.run/v1alpha1/paywall/purchase/*",
    "/apis/plugin-paywall.halo.run/v1alpha1/paywall/status",
    "/apis/plugin-paywall.halo.run/v1alpha1/paywall/status/*",
    "/apis/plugin-paywall.halo.run/v1alpha1/paywall/content",
    "/apis/plugin-paywall.halo.run/v1alpha1/paywall/content/*"
  ]
    verbs: ["create","get","list","watch","update","patch","delete"]




#apiVersion: v1alpha1
#kind: Role
#metadata:
#  name: plugin-encrypt-anonymous
#  labels:
#    halo.run/role-template: "true"
#    halo.run/hidden: "true"
#    # 关键配置：聚合到 anonymous 角色，这样所有人都能访问
#    rbac.authorization.halo.run/aggregate-to-anonymous: "true"
#rules:
##   资源型规则
#  - apiGroups: ["plugin-paywall.halo.run"]
#    resources: ["plugin-paywall/paywall"]
#    verbs: ["*"]
##   非资源型规则，因为这是一个自定义的API路径
#  - nonResourceURLs: [
#    "/apis/plugin-paywall.halo.run/v1alpha1/paywall/*"
#  ]
#    verbs: ["*"]
